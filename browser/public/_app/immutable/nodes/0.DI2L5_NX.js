import"../chunks/DsnmJJEf.js";import{a8 as Q,a9 as y,ae as t,ab as I,Q as o,ac as m,af as a,ag as u,ai as U,aj as W,ak as H,W as p,ad as E,al as K,ah as F,am as V,u as X,an as Y,ao as Z,aa as ee,ap as ae}from"../chunks/DTzQy__n.js";import{i as J}from"../chunks/CIPqIZ-G.js";import{e as te,s as se,i as re,g as oe,r as R,b as $,t as ie,A as le,S as i,a as z}from"../chunks/DJBZvoFV.js";const ne=!1,Ae=Object.freeze(Object.defineProperty({__proto__:null,ssr:ne},Symbol.toStringTag,{value:"Module"})),de=""+new URL("../assets/disk_usage.D6y1m4ri.svg",import.meta.url).href,ce=g=>g;function ve(g,{delay:_=0,duration:c=400,easing:b=ce}={}){const l=+getComputedStyle(g).opacity;return{delay:_,duration:c,easing:b,css:n=>`opacity: ${n*l}`}}var pe=y('<div class="w-10 h-2"></div>'),ue=y('<span class="animate-spin border-2 border-t-transparent rounded-full w-5 h-5 inline-block"></span>'),fe=y('<p class="w-1/2 bg-red-100 text-red-700 p-2 rounded text-sm text-center"> </p>'),me=y(`<div class="flex flex-col gap-4 justify-center items-center h-full text-white"><div class="flex gap-1"></div> <div class="flex flex-col gap-4 w-1/2 mt-20 items-center justify-center"><div class="flex flex-col gap-2 p-6 border w-full
            items-center justify-center
            border-gray-500 bg-gray-800 rounded-lg shadow-lg "><form class="space-y-4 w-full"><div><label class="block text-sm font-medium" for="username">Username</label> <input class="w-full" id="username" placeholder="Linux user" type="text" required/></div> <div><label class="block text-sm font-medium " for="password">Password</label> <input class="w-full" id="password" placeholder="Linux password" type="password" required/></div> <div class="flex items-right justify-end"><button class="btn w-full" type="submit"><!></button></div></form></div></div> <!> <div class="grow"></div></div>`);function ge(g,_){Q(_,!0);let c=U(void 0),b=U(void 0),l=U(void 0),n=U(""),j=`${le}/login`;function N(e){try{let d=(e.split(".")[1]||"").replace(/-/g,"+").replace(/_/g,"/");const S=d.length%4;S&&(d+="=".repeat(4-S));const x=atob(d);return JSON.parse(x)}catch{return{}}}const C=async e=>{try{p(l,!0),p(n,"");const s=await fetch(j,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:o(c),password:o(b)})}),d=await s.json().catch(()=>({}));if(s.ok){const S=d.access_token;if(!S){p(n,"Malformed server response (missing token).");return}const x=N(S);console.log("claims:",x);const we=x?.exp?x.exp*1e3:null;i.username=x?.sub||o(c),i.isAdmin=!!x?.is_admin,i.token=S,localStorage.setItem("state",JSON.stringify(i))}else p(n,d.error||d.detail||"Invalid credentials",!0)}catch(s){console.error(s),p(n,"Network error. Please try again.")}finally{p(b,""),p(l,!1)}};var w=me(),A=t(w);te(A,21,()=>oe(20),re,(e,s)=>{var d=pe();I(()=>se(d,`background: ${o(s)??""}`)),m(e,d)}),a(A);var h=u(A,2),D=t(h),L=t(D),O=t(L),r=u(t(O),2);R(r),a(O);var v=u(O,2),f=u(t(v),2);R(f),a(v);var T=u(v,2),k=t(T),q=t(k);{var B=e=>{var s=ue();m(e,s)},P=e=>{var s=K("Log in");m(e,s)};J(q,e=>{o(l)?e(B):e(P,!1)})}a(k),a(T),a(L),a(D),a(h);var M=u(h,2);{var G=e=>{var s=fe(),d=t(s,!0);a(s),I(()=>F(d,o(n))),m(e,s)};J(M,e=>{o(n)&&e(G)})}W(2),a(w),I(()=>{r.disabled=o(l),f.disabled=o(l),k.disabled=o(l)}),H("submit",L,C),$(r,()=>o(c),e=>p(c,e)),$(f,()=>o(b),e=>p(b,e)),ie(1,w,()=>ve,()=>({duration:500})),m(g,w),E()}function _e(g,_){_()}var be=y('<span class="px-2 py-1 rounded bg-emerald-600 text-white">Admin</span>'),xe=y('<div class="flex items-center gap-3 text-sm"><span class="opacity-80"> </span> <!> <button class="px-3 py-1 rounded bg-gray-700 hover:bg-gray-600">Logout</button></div>'),ye=y('<div class="flex flex-col h-screen min-h-0 overflow-hidden"><div class="flex items-center justify-between p-4 text-xl border-b border-gray-500 text-gray-200 select-none"><div class="flex gap-2 items-center"><div><img alt="logo"/></div> <div>Statwalker 2.0</div></div> <div class="grow"></div> <!></div> <div class="flex flex-col h-full overflow-hidden p-2 bg-[var(--color)]"><!></div></div>');function Le(g,_){Q(_,!0);let c=Y(()=>!!i.token&&(!i.expiresAt||Date.now()<i.expiresAt));X(()=>{p(c,!!i.token&&(!i.expiresAt||Date.now()<i.expiresAt))});function b(){i.logout(),localStorage.removeItem("state")}var l=ye(),n=t(l),j=t(n),N=t(j),C=t(N);z(C,"width",28),a(N),W(2),a(j);var w=u(j,4);{var A=r=>{var v=xe(),f=t(v),T=t(f,!0);a(f);var k=u(f,2);{var q=P=>{var M=be();m(P,M)};J(k,P=>{i.isAdmin&&P(q)})}var B=u(k,2);B.__click=[_e,b],a(v),I(()=>F(T,i.username)),m(r,v)};J(w,r=>{o(c)&&r(A)})}a(n);var h=u(n,2),D=t(h);{var L=r=>{var v=Z(),f=ee(v);ae(f,()=>_.children),m(r,v)},O=r=>{ge(r,{})};J(D,r=>{o(c)?r(L):r(O,!1)})}a(h),a(l),I(()=>z(C,"src",de)),m(g,l),E()}V(["click"]);export{Le as component,Ae as universal};
//# sourceMappingURL=0.DI2L5_NX.js.map
